{
  "paragraphs": [
    {
      "text": "%sh\nwget -O /datadrive/spark-streaming-kafka-0-8-assembly_2.11-2.2.1.jar  https://www.dropbox.com/s/mknk25eobup4fyy/spark-streaming-kafka-0-8-assembly_2.11-2.2.1.jar?dl\u003d1\nwget -O /datadrive/mongo-java-driver-3.4.2.jar https://www.dropbox.com/s/2gxcfoh13m7to18/mongo-java-driver-3.4.2.jar?dl\u003d1\nwget -O /datadrive/mongo-spark-connector_2.11-2.2.1.jar https://www.dropbox.com/s/ukvp40x81ouen08/mongo-spark-connector_2.11-2.2.1.jar?dl\u003d1\nwget -O /datadrive/scala-library-2.11.8.jar https://www.dropbox.com/s/m1i0i47cyocahuw/scala-library-2.11.8.jar?dl\u003d1",
      "user": "anonymous",
      "dateUpdated": "2020-12-17 08:03:21.246",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/sh",
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "--2020-12-17 08:03:23--  https://www.dropbox.com/s/mknk25eobup4fyy/spark-streaming-kafka-0-8-assembly_2.11-2.2.1.jar?dl\u003d1\nResolving www.dropbox.com (www.dropbox.com)... 162.125.82.18, 2620:100:6032:18::a27d:5212\nConnecting to www.dropbox.com (www.dropbox.com)|162.125.82.18|:443... connected.\nHTTP request sent, awaiting response... 301 Moved Permanently\nLocation: /s/dl/mknk25eobup4fyy/spark-streaming-kafka-0-8-assembly_2.11-2.2.1.jar [following]\n--2020-12-17 08:03:23--  https://www.dropbox.com/s/dl/mknk25eobup4fyy/spark-streaming-kafka-0-8-assembly_2.11-2.2.1.jar\nReusing existing connection to www.dropbox.com:443.\nHTTP request sent, awaiting response... 302 Found\nLocation: https://ucd116ee689f7f285ae4fbd8706a.dl.dropboxusercontent.com/cd/0/get/BFPwPSVmBctDt2LR5PwwO09XyA9mKAMySEvOGMrVlzr08RZDQEH1VeFLNUYFuGzZOFcN3pqn-bvUhVEjpV-l4ZeT9Eca04QzR1TInfGwYyWtSEePPUpWlGnKdfyl9PWrSpA/file?dl\u003d1# [following]\n--2020-12-17 08:03:23--  https://ucd116ee689f7f285ae4fbd8706a.dl.dropboxusercontent.com/cd/0/get/BFPwPSVmBctDt2LR5PwwO09XyA9mKAMySEvOGMrVlzr08RZDQEH1VeFLNUYFuGzZOFcN3pqn-bvUhVEjpV-l4ZeT9Eca04QzR1TInfGwYyWtSEePPUpWlGnKdfyl9PWrSpA/file?dl\u003d1\nResolving ucd116ee689f7f285ae4fbd8706a.dl.dropboxusercontent.com (ucd116ee689f7f285ae4fbd8706a.dl.dropboxusercontent.com)... 162.125.82.15, 2620:100:6032:15::a27d:520f\nConnecting to ucd116ee689f7f285ae4fbd8706a.dl.dropboxusercontent.com (ucd116ee689f7f285ae4fbd8706a.dl.dropboxusercontent.com)|162.125.82.15|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 12071569 (12M) [application/binary]\nSaving to: ‘/datadrive/spark-streaming-kafka-0-8-assembly_2.11-2.2.1.jar’\n\n     0K .......... .......... .......... .......... ..........  0%  264K 45s\n    50K .......... .......... .......... .......... ..........  0%  446K 35s\n   100K .......... .......... .......... .......... ..........  1%  689K 29s\n   150K .......... .......... .......... .......... ..........  1%  986K 25s\n   200K .......... .......... .......... .......... ..........  2% 1.31M 21s\n   250K .......... .......... .......... .......... ..........  2% 1.41M 19s\n   300K .......... .......... .......... .......... ..........  2% 1.65M 17s\n   350K .......... .......... .......... .......... ..........  3% 5.26M 15s\n   400K .......... .......... .......... .......... ..........  3% 2.35M 14s\n   450K .......... .......... .......... .......... ..........  4% 2.49M 13s\n   500K .......... .......... .......... .......... ..........  4% 3.14M 12s\n   550K .......... .......... .......... .......... ..........  5% 2.12M 11s\n   600K .......... .......... .......... .......... ..........  5% 2.78M 11s\n   650K .......... .......... .......... .......... ..........  5% 3.11M 10s\n   700K .......... .......... .......... .......... ..........  6% 2.53M 10s\n   750K .......... .......... .......... .......... ..........  6% 4.72M 9s\n   800K .......... .......... .......... .......... ..........  7% 5.29M 9s\n   850K .......... .......... .......... .......... ..........  7% 5.07M 8s\n   900K .......... .......... .......... .......... ..........  8% 5.59M 8s\n   950K .......... .......... .......... .......... ..........  8% 4.18M 8s\n  1000K .......... .......... .......... .......... ..........  8% 7.86M 7s\n  1050K .......... .......... .......... .......... ..........  9% 7.71M 7s\n  1100K .......... .......... .......... .......... ..........  9% 5.96M 7s\n  1150K .......... .......... .......... .......... .......... 10% 7.28M 7s\n  1200K .......... .......... .......... .......... .......... 10% 6.74M 6s\n  1250K .......... .......... .......... .......... .......... 11% 7.13M 6s\n  1300K .......... .......... .......... .......... .......... 11% 7.32M 6s\n  1350K .......... .......... .......... .......... .......... 11% 5.20M 6s\n  1400K .......... .......... .......... .......... .......... 12% 3.17M 6s\n  1450K .......... .......... .......... .......... .......... 12% 9.05M 5s\n  1500K .......... .......... .......... .......... .......... 13% 7.33M 5s\n  1550K .......... .......... .......... .......... .......... 13% 8.03M 5s\n  1600K .......... .......... .......... .......... .......... 13% 9.50M 5s\n  1650K .......... .......... .......... .......... .......... 14% 7.78M 5s\n  1700K .......... .......... .......... .......... .......... 14% 9.42M 5s\n  1750K .......... .......... .......... .......... .......... 15% 6.72M 5s\n  1800K .......... .......... .......... .......... .......... 15% 10.8M 4s\n  1850K .......... .......... .......... .......... .......... 16% 10.9M 4s\n  1900K .......... .......... .......... .......... .......... 16% 10.8M 4s\n  1950K .......... .......... .......... .......... .......... 16% 11.5M 4s\n  2000K .......... .......... .......... .......... .......... 17% 14.8M 4s\n  2050K .......... .......... .......... .......... .......... 17% 10.9M 4s\n  2100K .......... .......... .......... .......... .......... 18% 20.5M 4s\n  2150K .......... .......... .......... .......... .......... 18% 9.23M 4s\n  2200K .......... .......... .......... .......... .......... 19% 11.4M 4s\n  2250K .......... .......... .......... .......... .......... 19% 15.6M 4s\n  2300K .......... .......... .......... .......... .......... 19% 12.6M 4s\n  2350K .......... .......... .......... .......... .......... 20% 16.7M 3s\n  2400K .......... .......... .......... .......... .......... 20% 12.9M 3s\n  2450K .......... .......... .......... .......... .......... 21% 11.7M 3s\n  2500K .......... .......... .......... .......... .......... 21% 15.5M 3s\n  2550K .......... .......... .......... .......... .......... 22% 11.4M 3s\n  2600K .......... .......... .......... .......... .......... 22% 16.6M 3s\n  2650K .......... .......... .......... .......... .......... 22% 15.8M 3s\n  2700K .......... .......... .......... .......... .......... 23% 14.6M 3s\n  2750K .......... .......... .......... .......... .......... 23% 19.5M 3s\n  2800K .......... .......... .......... .......... .......... 24% 23.2M 3s\n  2850K .......... .......... .......... .......... .......... 24% 26.0M 3s\n  2900K .......... .......... .......... .......... .......... 25% 4.40M 3s\n  2950K .......... .......... .......... .......... .......... 25% 10.4M 3s\n  3000K .......... .......... .......... .......... .......... 25% 27.8M 3s\n  3050K .......... .......... .......... .......... .......... 26% 13.6M 3s\n  3100K .......... .......... .......... .......... .......... 26% 16.7M 3s\n  3150K .......... .......... .......... .......... .......... 27% 14.1M 3s\n  3200K .......... .......... .......... .......... .......... 27% 18.8M 2s\n  3250K .......... .......... .......... .......... .......... 27% 20.1M 2s\n  3300K .......... .......... .......... .......... .......... 28% 13.7M 2s\n  3350K .......... .......... .......... .......... .......... 28% 15.2M 2s\n  3400K .......... .......... .......... .......... .......... 29% 15.1M 2s\n  3450K .......... .......... .......... .......... .......... 29% 20.0M 2s\n  3500K .......... .......... .......... .......... .......... 30% 17.4M 2s\n  3550K .......... .......... .......... .......... .......... 30% 20.2M 2s\n  3600K .......... .......... .......... .......... .......... 30% 19.8M 2s\n  3650K .......... .......... .......... .......... .......... 31% 17.7M 2s\n  3700K .......... .......... .......... .......... .......... 31% 16.6M 2s\n  3750K .......... .......... .......... .......... .......... 32% 25.2M 2s\n  3800K .......... .......... .......... .......... .......... 32% 14.0M 2s\n  3850K .......... .......... .......... .......... .......... 33% 24.5M 2s\n  3900K .......... .......... .......... .......... .......... 33% 25.2M 2s\n  3950K .......... .......... .......... .......... .......... 33% 9.81M 2s\n  4000K .......... .......... .......... .......... .......... 34%  305M 2s\n  4050K .......... .......... .......... .......... .......... 34% 29.6M 2s\n  4100K .......... .......... .......... .......... .......... 35% 39.1M 2s\n  4150K .......... .......... .......... .......... .......... 35% 15.9M 2s\n  4200K .......... .......... .......... .......... .......... 36% 24.8M 2s\n  4250K .......... .......... .......... .......... .......... 36% 23.9M 2s\n  4300K .......... .......... .......... .......... .......... 36% 27.5M 2s\n  4350K .......... .......... .......... .......... .......... 37% 22.4M 2s\n  4400K .......... .......... .......... .......... .......... 37% 20.2M 2s\n  4450K .......... .......... .......... .......... .......... 38% 13.6M 2s\n  4500K .......... .......... .......... .......... .......... 38% 67.9M 2s\n  4550K .......... .......... .......... .......... .......... 39% 29.4M 2s\n  4600K .......... .......... .......... .......... .......... 39% 12.7M 2s\n  4650K .......... .......... .......... .......... .......... 39% 12.1M 2s\n  4700K .......... .......... .......... .......... .......... 40%  279M 2s\n  4750K .......... .......... .......... .......... .......... 40%  306M 1s\n  4800K .......... .......... .......... .......... .......... 41% 25.7M 1s\n  4850K .......... .......... .......... .......... .......... 41% 33.8M 1s\n  4900K .......... .......... .......... .......... .......... 41% 26.7M 1s\n  4950K .......... .......... .......... .......... .......... 42% 18.0M 1s\n  5000K .......... .......... .......... .......... .......... 42% 34.5M 1s\n  5050K .......... .......... .......... .......... .......... 43% 25.8M 1s\n  5100K .......... .......... .......... .......... .......... 43% 30.4M 1s\n  5150K .......... .......... .......... .......... .......... 44% 35.2M 1s\n  5200K .......... .......... .......... .......... .......... 44% 39.3M 1s\n  5250K .......... .......... .......... .......... .......... 44% 87.6M 1s\n  5300K .......... .......... .......... .......... .......... 45% 31.7M 1s\n  5350K .......... .......... .......... .......... .......... 45% 19.7M 1s\n  5400K .......... .......... .......... .......... .......... 46% 29.6M 1s\n  5450K .......... .......... .......... .......... .......... 46% 25.8M 1s\n  5500K .......... .......... .......... .......... .......... 47% 42.4M 1s\n  5550K .......... .......... .......... .......... .......... 47% 32.9M 1s\n  5600K .......... .......... .......... .......... .......... 47% 28.4M 1s\n  5650K .......... .......... .......... .......... .......... 48% 24.8M 1s\n  5700K .......... .......... .......... .......... .......... 48% 40.3M 1s\n  5750K .......... .......... .......... .......... .......... 49% 24.2M 1s\n  5800K .......... .......... .......... .......... .......... 49% 27.0M 1s\n  5850K .......... .......... .......... .......... .......... 50% 9.97M 1s\n  5900K .......... .......... .......... .......... .......... 50% 33.6M 1s\n  5950K .......... .......... .......... .......... .......... 50% 38.4M 1s\n  6000K .......... .......... .......... .......... .......... 51% 30.3M 1s\n  6050K .......... .......... .......... .......... .......... 51% 52.3M 1s\n  6100K .......... .......... .......... .......... .......... 52% 25.7M 1s\n  6150K .......... .......... .......... .......... .......... 52%  879K 1s\n  6200K .......... .......... .......... .......... .......... 53% 32.1M 1s\n  6250K .......... .......... .......... .......... .......... 53% 50.8M 1s\n  6300K .......... .......... .......... .......... .......... 53% 13.0M 1s\n  6350K .......... .......... .......... .......... .......... 54%  208M 1s\n  6400K .......... .......... .......... .......... .......... 54%  256M 1s\n  6450K .......... .......... .......... .......... .......... 55%  257M 1s\n  6500K .......... .......... .......... .......... .......... 55%  231M 1s\n  6550K .......... .......... .......... .......... .......... 55% 53.7M 1s\n  6600K .......... .......... .......... .......... .......... 56% 67.7M 1s\n  6650K .......... .......... .......... .......... .......... 56% 83.5M 1s\n  6700K .......... .......... .......... .......... .......... 57% 87.7M 1s\n  6750K .......... .......... .......... .......... .......... 57% 85.8M 1s\n  6800K .......... .......... .......... .......... .......... 58% 44.9M 1s\n  6850K .......... .......... .......... .......... .......... 58% 87.1M 1s\n  6900K .......... .......... .......... .......... .......... 58% 88.6M 1s\n  6950K .......... .......... .......... .......... .......... 59% 14.7M 1s\n  7000K .......... .......... .......... .......... .......... 59%  289M 1s\n  7050K .......... .......... .......... .......... .......... 60% 82.2M 1s\n  7100K .......... .......... .......... .......... .......... 60%  229M 1s\n  7150K .......... .......... .......... .......... .......... 61%  182M 1s\n  7200K .......... .......... .......... .......... .......... 61%  255M 1s\n  7250K .......... .......... .......... .......... .......... 61%  284M 1s\n  7300K .......... .......... .......... .......... .......... 62%  134M 1s\n  7350K .......... .......... .......... .......... .......... 62% 90.0M 1s\n  7400K .......... .......... .......... .......... .......... 63% 28.9M 1s\n  7450K .......... .......... .......... .......... .......... 63% 6.73M 1s\n  7500K .......... .......... .......... .......... .......... 64%  122M 1s\n  7550K .......... .......... .......... .......... .......... 64%  196M 1s\n  7600K .......... .......... .......... .......... .......... 64%  179M 1s\n  7650K .......... .......... .......... .......... .......... 65%  229M 1s\n  7700K .......... .......... .......... .......... .......... 65%  279M 1s\n  7750K .......... .......... .......... .......... .......... 66%  236M 1s\n  7800K .......... .......... .......... .......... .......... 66%  277M 1s\n  7850K .......... .......... .......... .......... .......... 67%  251M 1s\n  7900K .......... .......... .......... .......... .......... 67%  277M 1s\n  7950K .......... .......... .......... .......... .......... 67%  227M 1s\n  8000K .......... .......... .......... .......... .......... 68%  244M 1s\n  8050K .......... .......... .......... .......... .......... 68%  221M 1s\n  8100K .......... .......... .......... .......... .......... 69%  232M 1s\n  8150K .......... .......... .......... .......... .......... 69%  243M 1s\n  8200K .......... .......... .......... .......... .......... 69%  493K 1s\n  8250K .......... .......... .......... .......... .......... 70% 55.7M 1s\n  8300K .......... .......... .......... .......... .......... 70% 67.0M 1s\n  8350K .......... .......... .......... .......... .......... 71% 96.0M 1s\n  8400K .......... .......... .......... .......... .......... 71% 11.7M 0s\n  8450K .......... .......... .......... .......... .......... 72% 43.7M 0s\n  8500K .......... .......... .......... .......... .......... 72%  168M 0s\n  8550K .......... .......... .......... .......... .......... 72%  204M 0s\n  8600K .......... .......... .......... .......... .......... 73%  208M 0s\n  8650K .......... .......... .......... .......... .......... 73%  239M 0s\n  8700K .......... .......... .......... .......... .......... 74%  245M 0s\n  8750K .......... .......... .......... .......... .......... 74% 95.5M 0s\n  8800K .......... .......... .......... .......... .......... 75% 64.1M 0s\n  8850K .......... .......... .......... .......... .......... 75% 85.1M 0s\n  8900K .......... .......... .......... .......... .......... 75% 85.9M 0s\n  8950K .......... .......... .......... .......... .......... 76%  117M 0s\n  9000K .......... .......... .......... .......... .......... 76% 11.7M 0s\n  9050K .......... .......... .......... .......... .......... 77%  252M 0s\n  9100K .......... .......... .......... .......... .......... 77%  250M 0s\n  9150K .......... .......... .......... .......... .......... 78%  220M 0s\n  9200K .......... .......... .......... .......... .......... 78%  238M 0s\n  9250K .......... .......... .......... .......... .......... 78%  253M 0s\n  9300K .......... .......... .......... .......... .......... 79%  270M 0s\n  9350K .......... .......... .......... .......... .......... 79%  100M 0s\n  9400K .......... .......... .......... .......... .......... 80% 64.3M 0s\n  9450K .......... .......... .......... .......... .......... 80% 62.9M 0s\n  9500K .......... .......... .......... .......... .......... 81% 73.1M 0s\n  9550K .......... .......... .......... .......... .......... 81% 93.4M 0s\n  9600K .......... .......... .......... .......... .......... 81% 54.5M 0s\n  9650K .......... .......... .......... .......... .......... 82% 53.5M 0s\n  9700K .......... .......... .......... .......... .......... 82% 67.2M 0s\n  9750K .......... .......... .......... .......... .......... 83% 64.9M 0s\n  9800K .......... .......... .......... .......... .......... 83% 88.5M 0s\n  9850K .......... .......... .......... .......... .......... 83% 91.7M 0s\n  9900K .......... .......... .......... .......... .......... 84% 53.4M 0s\n  9950K .......... .......... .......... .......... .......... 84% 90.5M 0s\n 10000K .......... .......... .......... .......... .......... 85% 55.8M 0s\n 10050K .......... .......... .......... .......... .......... 85% 67.2M 0s\n 10100K .......... .......... .......... .......... .......... 86% 17.1M 0s\n 10150K .......... .......... .......... .......... .......... 86%  387M 0s\n 10200K .......... .......... .......... .......... .......... 86%  494K 0s\n 10250K .......... .......... .......... .......... .......... 87% 88.8M 0s\n 10300K .......... .......... .......... .......... .......... 87% 55.2M 0s\n 10350K .......... .......... .......... .......... .......... 88% 64.7M 0s\n 10400K .......... .......... .......... .......... .......... 88% 86.6M 0s\n 10450K .......... .......... .......... .......... .......... 89% 63.9M 0s\n 10500K .......... .......... .......... .......... .......... 89% 96.6M 0s\n 10550K .......... .......... .......... .......... .......... 89% 68.4M 0s\n 10600K .......... .......... .......... .......... .......... 90% 68.7M 0s\n 10650K .......... .......... .......... .......... .......... 90% 90.1M 0s\n 10700K .......... .......... .......... .......... .......... 91% 59.4M 0s\n 10750K .......... .......... .......... .......... .......... 91% 89.5M 0s\n 10800K .......... .......... .......... .......... .......... 92% 90.5M 0s\n 10850K .......... .......... .......... .......... .......... 92% 89.9M 0s\n 10900K .......... .......... .......... .......... .......... 92% 65.8M 0s\n 10950K .......... .......... .......... .......... .......... 93% 65.3M 0s\n 11000K .......... .......... .......... .......... .......... 93% 68.8M 0s\n 11050K .......... .......... .......... .......... .......... 94% 69.3M 0s\n 11100K .......... .......... .......... .......... .......... 94% 65.3M 0s\n 11150K .......... .......... .......... .......... .......... 95% 15.6M 0s\n 11200K .......... .......... .......... .......... .......... 95%  293M 0s\n 11250K .......... .......... .......... .......... .......... 95%  268M 0s\n 11300K .......... .......... .......... .......... .......... 96%  301M 0s\n 11350K .......... .......... .......... .......... .......... 96%  239M 0s\n 11400K .......... .......... .......... .......... .......... 97%  268M 0s\n 11450K .......... .......... .......... .......... .......... 97% 97.8M 0s\n 11500K .......... .......... .......... .......... .......... 97% 85.3M 0s\n 11550K .......... .......... .......... .......... .......... 98% 65.1M 0s\n 11600K .......... .......... .......... .......... .......... 98% 64.9M 0s\n 11650K .......... .......... .......... .......... .......... 99% 88.0M 0s\n 11700K .......... .......... .......... .......... .......... 99% 49.4M 0s\n 11750K .......... .......... .......... ........             100%  106M\u003d1.4s\n\n2020-12-17 08:03:25 (8.21 MB/s) - ‘/datadrive/spark-streaming-kafka-0-8-assembly_2.11-2.2.1.jar’ saved [12071569/12071569]\n\n--2020-12-17 08:03:25--  https://www.dropbox.com/s/2gxcfoh13m7to18/mongo-java-driver-3.4.2.jar?dl\u003d1\nResolving www.dropbox.com (www.dropbox.com)... 162.125.82.18, 2620:100:6032:18::a27d:5212\nConnecting to www.dropbox.com (www.dropbox.com)|162.125.82.18|:443... connected.\nHTTP request sent, awaiting response... 301 Moved Permanently\nLocation: /s/dl/2gxcfoh13m7to18/mongo-java-driver-3.4.2.jar [following]\n--2020-12-17 08:03:26--  https://www.dropbox.com/s/dl/2gxcfoh13m7to18/mongo-java-driver-3.4.2.jar\nReusing existing connection to www.dropbox.com:443.\nHTTP request sent, awaiting response... 302 Found\nLocation: https://uc08340299fdf6ca38b475f3e6d4.dl.dropboxusercontent.com/cd/0/get/BFOf3Pn_kSvvIJeqSKgSO8ust0WtEHKNAmFSEj_xrynK4mo6UutnNWz5Ca9wgpXWeXW3DxiiqFcs_XqcxouOd-TDW5bonC5ROX94nx6E0KKZauPr88FXezqdQtufwy2sc6Q/file?dl\u003d1# [following]\n--2020-12-17 08:03:26--  https://uc08340299fdf6ca38b475f3e6d4.dl.dropboxusercontent.com/cd/0/get/BFOf3Pn_kSvvIJeqSKgSO8ust0WtEHKNAmFSEj_xrynK4mo6UutnNWz5Ca9wgpXWeXW3DxiiqFcs_XqcxouOd-TDW5bonC5ROX94nx6E0KKZauPr88FXezqdQtufwy2sc6Q/file?dl\u003d1\nResolving uc08340299fdf6ca38b475f3e6d4.dl.dropboxusercontent.com (uc08340299fdf6ca38b475f3e6d4.dl.dropboxusercontent.com)... 162.125.82.15, 2620:100:6032:15::a27d:520f\nConnecting to uc08340299fdf6ca38b475f3e6d4.dl.dropboxusercontent.com (uc08340299fdf6ca38b475f3e6d4.dl.dropboxusercontent.com)|162.125.82.15|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 1673643 (1.6M) [application/binary]\nSaving to: ‘/datadrive/mongo-java-driver-3.4.2.jar’\n\n     0K .......... .......... .......... .......... ..........  3% 9.55M 0s\n    50K .......... .......... .......... .......... ..........  6% 18.0M 0s\n   100K .......... .......... .......... .......... ..........  9% 15.7M 0s\n   150K .......... .......... .......... .......... .......... 12% 30.8M 0s\n   200K .......... .......... .......... .......... .......... 15% 24.1M 0s\n   250K .......... .......... .......... .......... .......... 18% 43.2M 0s\n   300K .......... .......... .......... .......... .......... 21% 93.0M 0s\n   350K .......... .......... .......... .......... .......... 24% 47.4M 0s\n   400K .......... .......... .......... .......... .......... 27% 11.0M 0s\n   450K .......... .......... .......... .......... .......... 30%  399K 0s\n   500K .......... .......... .......... .......... .......... 33% 43.3M 0s\n   550K .......... .......... .......... .......... .......... 36% 33.3M 0s\n   600K .......... .......... .......... .......... .......... 39% 51.7M 0s\n   650K .......... .......... .......... .......... .......... 42% 42.9M 0s\n   700K .......... .......... .......... .......... .......... 45% 54.0M 0s\n   750K .......... .......... .......... .......... .......... 48% 43.6M 0s\n   800K .......... .......... .......... .......... .......... 52% 48.7M 0s\n   850K .......... .......... .......... .......... .......... 55% 39.0M 0s\n   900K .......... .......... .......... .......... .......... 58% 54.5M 0s\n   950K .......... .......... .......... .......... .......... 61% 33.5M 0s\n  1000K .......... .......... .......... .......... .......... 64% 46.0M 0s\n  1050K .......... .......... .......... .......... .......... 67% 36.8M 0s\n  1100K .......... .......... .......... .......... .......... 70%  377K 0s\n  1150K .......... .......... .......... .......... .......... 73% 44.1M 0s\n  1200K .......... .......... .......... .......... .......... 76% 32.2M 0s\n  1250K .......... .......... .......... .......... .......... 79% 49.1M 0s\n  1300K .......... .......... .......... .......... .......... 82% 49.2M 0s\n  1350K .......... .......... .......... .......... .......... 85% 30.4M 0s\n  1400K .......... .......... .......... .......... .......... 88% 52.4M 0s\n  1450K .......... .......... .......... .......... .......... 91% 38.4M 0s\n  1500K .......... .......... .......... .......... .......... 94% 38.3M 0s\n  1550K .......... .......... .......... .......... .......... 97% 63.3M 0s\n  1600K .......... .......... .......... ....                 100% 6.67M\u003d0.3s\n\n2020-12-17 08:03:27 (5.17 MB/s) - ‘/datadrive/mongo-java-driver-3.4.2.jar’ saved [1673643/1673643]\n\n--2020-12-17 08:03:27--  https://www.dropbox.com/s/ukvp40x81ouen08/mongo-spark-connector_2.11-2.2.1.jar?dl\u003d1\nResolving www.dropbox.com (www.dropbox.com)... 162.125.82.18, 2620:100:6032:18::a27d:5212\nConnecting to www.dropbox.com (www.dropbox.com)|162.125.82.18|:443... connected.\nHTTP request sent, awaiting response... 301 Moved Permanently\nLocation: /s/dl/ukvp40x81ouen08/mongo-spark-connector_2.11-2.2.1.jar [following]\n--2020-12-17 08:03:27--  https://www.dropbox.com/s/dl/ukvp40x81ouen08/mongo-spark-connector_2.11-2.2.1.jar\nReusing existing connection to www.dropbox.com:443.\nHTTP request sent, awaiting response... 302 Found\nLocation: https://ucfe9407d7aa3877263a3b4a63f4.dl.dropboxusercontent.com/cd/0/get/BFNvi7xHFgsL1K7JX2nco3_7hUzR6j58IcCBOqSe9xgDPJVADWFjV7GPKlgTWydtQtOemV97FJ8YFa6s-uh-lbO5LI-zPx46iZlLLVLbRgohjW2UrTFDxpQOkrSnDmoYhUg/file?dl\u003d1# [following]\n--2020-12-17 08:03:27--  https://ucfe9407d7aa3877263a3b4a63f4.dl.dropboxusercontent.com/cd/0/get/BFNvi7xHFgsL1K7JX2nco3_7hUzR6j58IcCBOqSe9xgDPJVADWFjV7GPKlgTWydtQtOemV97FJ8YFa6s-uh-lbO5LI-zPx46iZlLLVLbRgohjW2UrTFDxpQOkrSnDmoYhUg/file?dl\u003d1\nResolving ucfe9407d7aa3877263a3b4a63f4.dl.dropboxusercontent.com (ucfe9407d7aa3877263a3b4a63f4.dl.dropboxusercontent.com)... 162.125.82.15, 2620:100:6032:15::a27d:520f\nConnecting to ucfe9407d7aa3877263a3b4a63f4.dl.dropboxusercontent.com (ucfe9407d7aa3877263a3b4a63f4.dl.dropboxusercontent.com)|162.125.82.15|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 688656 (673K) [application/binary]\nSaving to: ‘/datadrive/mongo-spark-connector_2.11-2.2.1.jar’\n\n     0K .......... .......... .......... .......... ..........  7% 9.27M 0s\n    50K .......... .......... .......... .......... .......... 14% 27.1M 0s\n   100K .......... .......... .......... .......... .......... 22% 14.4M 0s\n   150K .......... .......... .......... .......... .......... 29% 13.5M 0s\n   200K .......... .......... .......... .......... .......... 37%  116M 0s\n   250K .......... .......... .......... .......... .......... 44% 27.8M 0s\n   300K .......... .......... .......... .......... .......... 52% 36.5M 0s\n   350K .......... .......... .......... .......... .......... 59% 68.8M 0s\n   400K .......... .......... .......... .......... .......... 66%  389K 0s\n   450K .......... .......... .......... .......... .......... 74% 46.2M 0s\n   500K .......... .......... .......... .......... .......... 81% 44.0M 0s\n   550K .......... .......... .......... .......... .......... 89% 23.6M 0s\n   600K .......... .......... .......... .......... .......... 96% 20.9M 0s\n   650K .......... .......... ..                              100% 98.8M\u003d0.2s\n\n2020-12-17 08:03:28 (4.28 MB/s) - ‘/datadrive/mongo-spark-connector_2.11-2.2.1.jar’ saved [688656/688656]\n\n--2020-12-17 08:03:28--  https://www.dropbox.com/s/m1i0i47cyocahuw/scala-library-2.11.8.jar?dl\u003d1\nResolving www.dropbox.com (www.dropbox.com)... 162.125.82.18, 2620:100:6032:18::a27d:5212\nConnecting to www.dropbox.com (www.dropbox.com)|162.125.82.18|:443... connected.\nHTTP request sent, awaiting response... 301 Moved Permanently\nLocation: /s/dl/m1i0i47cyocahuw/scala-library-2.11.8.jar [following]\n--2020-12-17 08:03:29--  https://www.dropbox.com/s/dl/m1i0i47cyocahuw/scala-library-2.11.8.jar\nReusing existing connection to www.dropbox.com:443.\nHTTP request sent, awaiting response... 302 Found\nLocation: https://uc31e3385101613df2c7daf54211.dl.dropboxusercontent.com/cd/0/get/BFM-K9a6zNGPax2_uvx0zN60a5rjCAaQ6miPntkfhDIGtP2HyiyB0F6PSHE_L3dh20Jqgqwf72aGnF2dj-NHJlHZ38HV9JKB8NhIsvjelIqyGV9nZEbULkGkVm4_jcLwQ_Q/file?dl\u003d1# [following]\n--2020-12-17 08:03:29--  https://uc31e3385101613df2c7daf54211.dl.dropboxusercontent.com/cd/0/get/BFM-K9a6zNGPax2_uvx0zN60a5rjCAaQ6miPntkfhDIGtP2HyiyB0F6PSHE_L3dh20Jqgqwf72aGnF2dj-NHJlHZ38HV9JKB8NhIsvjelIqyGV9nZEbULkGkVm4_jcLwQ_Q/file?dl\u003d1\nResolving uc31e3385101613df2c7daf54211.dl.dropboxusercontent.com (uc31e3385101613df2c7daf54211.dl.dropboxusercontent.com)... 162.125.82.15, 2620:100:6032:15::a27d:520f\nConnecting to uc31e3385101613df2c7daf54211.dl.dropboxusercontent.com (uc31e3385101613df2c7daf54211.dl.dropboxusercontent.com)|162.125.82.15|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 5744974 (5.5M) [application/binary]\nSaving to: ‘/datadrive/scala-library-2.11.8.jar’\n\n     0K .......... .......... .......... .......... ..........  0% 6.37M 1s\n    50K .......... .......... .......... .......... ..........  1% 29.0M 1s\n   100K .......... .......... .......... .......... ..........  2% 13.9M 0s\n   150K .......... .......... .......... .......... ..........  3% 17.1M 0s\n   200K .......... .......... .......... .......... ..........  4% 12.0M 0s\n   250K .......... .......... .......... .......... ..........  5%  242M 0s\n   300K .......... .......... .......... .......... ..........  6%  225M 0s\n   350K .......... .......... .......... .......... ..........  7%  214M 0s\n   400K .......... .......... .......... .......... ..........  8%  399K 2s\n   450K .......... .......... .......... .......... ..........  8% 66.7M 1s\n   500K .......... .......... .......... .......... ..........  9% 56.9M 1s\n   550K .......... .......... .......... .......... .......... 10% 27.6M 1s\n   600K .......... .......... .......... .......... .......... 11% 44.3M 1s\n   650K .......... .......... .......... .......... .......... 12% 53.9M 1s\n   700K .......... .......... .......... .......... .......... 13% 30.6M 1s\n   750K .......... .......... .......... .......... .......... 14% 44.3M 1s\n   800K .......... .......... .......... .......... .......... 15% 44.2M 1s\n   850K .......... .......... .......... .......... .......... 16% 45.4M 1s\n   900K .......... .......... .......... .......... .......... 16% 33.4M 1s\n   950K .......... .......... .......... .......... .......... 17% 32.1M 1s\n  1000K .......... .......... .......... .......... .......... 18% 43.1M 1s\n  1050K .......... .......... .......... .......... .......... 19% 38.4M 1s\n  1100K .......... .......... .......... .......... .......... 20% 38.3M 1s\n  1150K .......... .......... .......... .......... .......... 21% 51.2M 1s\n  1200K .......... .......... .......... .......... .......... 22% 36.8M 1s\n  1250K .......... .......... .......... .......... .......... 23% 38.7M 1s\n  1300K .......... .......... .......... .......... .......... 24% 19.7M 1s\n  1350K .......... .......... .......... .......... .......... 24% 53.7M 1s\n  1400K .......... .......... .......... .......... .......... 25%  406K 1s\n  1450K .......... .......... .......... .......... .......... 26% 44.1M 1s\n  1500K .......... .......... .......... .......... .......... 27% 36.4M 1s\n  1550K .......... .......... .......... .......... .......... 28% 64.5M 1s\n  1600K .......... .......... .......... .......... .......... 29% 31.5M 1s\n  1650K .......... .......... .......... .......... .......... 30% 53.1M 1s\n  1700K .......... .......... .......... .......... .......... 31% 34.1M 1s\n  1750K .......... .......... .......... .......... .......... 32% 30.2M 1s\n  1800K .......... .......... .......... .......... .......... 32% 42.1M 1s\n  1850K .......... .......... .......... .......... .......... 33% 38.3M 1s\n  1900K .......... .......... .......... .......... .......... 34% 53.1M 1s\n  1950K .......... .......... .......... .......... .......... 35% 27.5M 1s\n  2000K .......... .......... .......... .......... .......... 36% 37.3M 1s\n  2050K .......... .......... .......... .......... .......... 37% 66.4M 1s\n  2100K .......... .......... .......... .......... .......... 38% 44.5M 0s\n  2150K .......... .......... .......... .......... .......... 39% 28.2M 0s\n  2200K .......... .......... .......... .......... .......... 40% 39.5M 0s\n  2250K .......... .......... .......... .......... .......... 40% 35.4M 0s\n  2300K .......... .......... .......... .......... .......... 41% 54.5M 0s\n  2350K .......... .......... .......... .......... .......... 42% 47.2M 0s\n  2400K .......... .......... .......... .......... .......... 43% 34.4M 0s\n  2450K .......... .......... .......... .......... .......... 44% 34.2M 0s\n  2500K .......... .......... .......... .......... .......... 45% 45.2M 0s\n  2550K .......... .......... .......... .......... .......... 46% 31.5M 0s\n  2600K .......... .......... .......... .......... .......... 47% 23.5M 0s\n  2650K .......... .......... .......... .......... .......... 48% 65.9M 0s\n  2700K .......... .......... .......... .......... .......... 49%  435K 0s\n  2750K .......... .......... .......... .......... .......... 49% 43.2M 0s\n  2800K .......... .......... .......... .......... .......... 50% 41.2M 0s\n  2850K .......... .......... .......... .......... .......... 51% 56.2M 0s\n  2900K .......... .......... .......... .......... .......... 52% 38.3M 0s\n  2950K .......... .......... .......... .......... .......... 53% 27.8M 0s\n  3000K .......... .......... .......... .......... .......... 54% 42.1M 0s\n  3050K .......... .......... .......... .......... .......... 55% 56.5M 0s\n  3100K .......... .......... .......... .......... .......... 56% 27.9M 0s\n  3150K .......... .......... .......... .......... .......... 57% 44.1M 0s\n  3200K .......... .......... .......... .......... .......... 57% 43.0M 0s\n  3250K .......... .......... .......... .......... .......... 58% 52.7M 0s\n  3300K .......... .......... .......... .......... .......... 59% 32.2M 0s\n  3350K .......... .......... .......... .......... .......... 60% 31.9M 0s\n  3400K .......... .......... .......... .......... .......... 61% 39.2M 0s\n  3450K .......... .......... .......... .......... .......... 62% 37.2M 0s\n  3500K .......... .......... .......... .......... .......... 63% 14.1M 0s\n  3550K .......... .......... .......... .......... .......... 64%  257M 0s\n  3600K .......... .......... .......... .......... .......... 65%  291M 0s\n  3650K .......... .......... .......... .......... .......... 65% 55.6M 0s\n  3700K .......... .......... .......... .......... .......... 66% 28.8M 0s\n  3750K .......... .......... .......... .......... .......... 67% 39.2M 0s\n  3800K .......... .......... .......... .......... .......... 68% 58.1M 0s\n  3850K .......... .......... .......... .......... .......... 69% 34.0M 0s\n  3900K .......... .......... .......... .......... .......... 70% 38.3M 0s\n  3950K .......... .......... .......... .......... .......... 71% 44.0M 0s\n  4000K .......... .......... .......... .......... .......... 72% 45.3M 0s\n  4050K .......... .......... .......... .......... .......... 73% 30.2M 0s\n  4100K .......... .......... .......... .......... .......... 73% 54.5M 0s\n  4150K .......... .......... .......... .......... .......... 74% 39.6M 0s\n  4200K .......... .......... .......... .......... .......... 75% 28.8M 0s\n  4250K .......... .......... .......... .......... .......... 76% 38.4M 0s\n  4300K .......... .......... .......... .......... .......... 77% 44.0M 0s\n  4350K .......... .......... .......... .......... .......... 78%  470K 0s\n  4400K .......... .......... .......... .......... .......... 79% 42.0M 0s\n  4450K .......... .......... .......... .......... .......... 80% 36.4M 0s\n  4500K .......... .......... .......... .......... .......... 81% 50.0M 0s\n  4550K .......... .......... .......... .......... .......... 81% 35.4M 0s\n  4600K .......... .......... .......... .......... .......... 82% 24.3M 0s\n  4650K .......... .......... .......... .......... .......... 83% 88.5M 0s\n  4700K .......... .......... .......... .......... .......... 84% 48.7M 0s\n  4750K .......... .......... .......... .......... .......... 85% 33.4M 0s\n  4800K .......... .......... .......... .......... .......... 86% 36.7M 0s\n  4850K .......... .......... .......... .......... .......... 87% 13.4M 0s\n  4900K .......... .......... .......... .......... .......... 88%  465M 0s\n  4950K .......... .......... .......... .......... .......... 89%  426M 0s\n  5000K .......... .......... .......... .......... .......... 90% 30.8M 0s\n  5050K .......... .......... .......... .......... .......... 90% 48.1M 0s\n  5100K .......... .......... .......... .......... .......... 91% 41.0M 0s\n  5150K .......... .......... .......... .......... .......... 92% 35.6M 0s\n  5200K .......... .......... .......... .......... .......... 93% 63.9M 0s\n  5250K .......... .......... .......... .......... .......... 94% 37.9M 0s\n  5300K .......... .......... .......... .......... .......... 95% 31.8M 0s\n  5350K .......... .......... .......... .......... .......... 96% 48.1M 0s\n  5400K .......... .......... .......... .......... .......... 97% 32.6M 0s\n  5450K .......... .......... .......... .......... .......... 98% 41.5M 0s\n  5500K .......... .......... .......... .......... .......... 98% 39.2M 0s\n  5550K .......... .......... .......... .......... .......... 99% 25.6M 0s\n  5600K ..........                                            100%  262M\u003d0.6s\n\n2020-12-17 08:03:30 (8.89 MB/s) - ‘/datadrive/scala-library-2.11.8.jar’ saved [5744974/5744974]\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1608166247933_-517599194",
      "id": "20201217-005047_993584903",
      "dateCreated": "2020-12-17 00:50:47.933",
      "dateStarted": "2020-12-17 08:03:21.306",
      "dateFinished": "2020-12-17 08:03:30.728",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%dep\nz.load(\"/datadrive/spark-streaming-kafka-0-8-assembly_2.11-2.2.1.jar\")\nz.load(\"/datadrive/mongo-java-driver-3.4.2.jar\")\nz.load(\"/datadrive/mongo-spark-connector_2.11-2.2.1.jar\")\nz.load(\"/datadrive/scala-library-2.11.8.jar\")",
      "user": "anonymous",
      "dateUpdated": "2020-12-17 08:03:23.300",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "editorHide": false,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "res0: org.apache.zeppelin.dep.Dependency \u003d org.apache.zeppelin.dep.Dependency@6094d198\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1608125461404_-1992919619",
      "id": "20201216-133101_1091939710",
      "dateCreated": "2020-12-16 13:31:01.404",
      "dateStarted": "2020-12-17 08:03:23.334",
      "dateFinished": "2020-12-17 08:03:27.345",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\npip install kafka-python",
      "user": "anonymous",
      "dateUpdated": "2020-12-17 08:03:26.162",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/sh",
        "tableHide": false,
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Requirement already satisfied (use --upgrade to upgrade): kafka-python in /opt/conda/lib/python2.7/site-packages\nYou are using pip version 8.1.2, however version 20.3.3 is available.\nYou should consider upgrading via the \u0027pip install --upgrade pip\u0027 command.\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1556538860554_-1121550077",
      "id": "20190429-115420_1698791579",
      "dateCreated": "2019-04-29 11:54:20.554",
      "dateStarted": "2020-12-17 08:03:26.195",
      "dateFinished": "2020-12-17 08:03:26.416",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "",
      "text": "%producer.pyspark\n# def csv_reader(file_name):\n#     for row in open(file_name, \"r\"):\n#         yield row\n\nimport time \nimport random \n\nwith open(\u0027/datadrive/2019Oct.csv\u0027) as f:\n    header \u003d f.readline().split(\"\\n\")[0].split(\",\")\nprint(header)\n    \ncsv_gen \u003d (row.split(\"\\n\")[0].split(\",\") for row in open(\"/datadrive/2019Oct.csv\",\"r\"))\nnext(csv_gen)  # skip the header\n\"\"\" generator test kit\n# csv_gen \u003d (row for row in open(\"/datadrive/2019Oct.csv\",\"r\"))\nfor idx,i in enumerate(csv_gen):\n    dict_ \u003d dict(zip(header, i))\n    dict_[\"price\"] \u003d float(dict_[\"price\"])\n    # print(dict_)\n    time.sleep(0.1)\n    # if idx \u003d\u003d5:\n    #     break\n\"\"\"\n",
      "user": "anonymous",
      "dateUpdated": "2020-12-17 08:03:32.829",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 314.0,
              "optionOpen": false
            }
          }
        },
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python",
        "editorHide": false,
        "tableHide": false,
        "title": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "[\u0027event_time\u0027, \u0027event_type\u0027, \u0027product_id\u0027, \u0027category_id\u0027, \u0027category_code\u0027, \u0027brand\u0027, \u0027price\u0027, \u0027user_id\u0027, \u0027user_session\u0027]\n\u0027 generator test kit\\n# csv_gen \u003d (row for row in open(\"/datadrive/2019Oct.csv\",\"r\"))\\nfor idx,i in enumerate(csv_gen):\\n    dict_ \u003d dict(zip(header, i))\\n    dict_[\"price\"] \u003d float(dict_[\"price\"])\\n    # print(dict_)\\n    time.sleep(0.1)\\n    # if idx \u003d\u003d5:\\n    #     break\\n\u0027"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1556120282490_1275576273",
      "id": "20190424-153802_2004623441",
      "dateCreated": "2019-04-24 15:38:02.490",
      "dateStarted": "2020-12-17 08:03:32.850",
      "dateFinished": "2020-12-17 08:03:40.733",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%producer.pyspark\nimport time\nimport json\nimport random\nimport logging\n\nfrom kafka import KafkaProducer\nfrom kafka.errors import KafkaError\n\nKAFKA_BROKER \u003d \"172.25.0.12:9092\"\nKAFKA_TOPIC \u003d \"default_topic\"\n\nproducer \u003d KafkaProducer(bootstrap_servers\u003d[KAFKA_BROKER])\n# index \u003d 0\nfor idx, v in enumerate(csv_gen):\n    row_dict \u003d next(csv_gen)\n    row_dict \u003d dict(zip(header, row_dict))\n    row_dict[\"price\"] \u003d float(row_dict[\"price\"])\n    \n    future \u003d producer.send(\n        topic\u003dKAFKA_TOPIC, \n        key\u003dstr(idx).encode(\"utf-8\"),\n        value\u003djson.dumps(row_dict).encode(\"utf-8\"))\n    \n    try:\n        record_metadata \u003d future.get(timeout\u003d10)\n    except KafkaError:\n        # Decide what to do if produce request failed...\n        logging.exception(\"Error\")\n        pass\n    # print(idx)\n    \n    producer.flush()\n    \n    # time.sleep(random.uniform(0.05,3.0))\n",
      "user": "anonymous",
      "dateUpdated": "2020-12-17 08:03:37.185",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python",
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1608128074727_452590710",
      "id": "20201216-141434_2112638753",
      "dateCreated": "2020-12-16 14:14:34.727",
      "dateStarted": "2020-12-17 08:03:37.207",
      "dateFinished": "2020-12-17 06:54:54.087",
      "status": "ABORT",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%consumer.pyspark\nimport pyspark.sql.functions as f\n\ndef transformer(rdd):\n    df \u003d rdd.toDF()\n\n    original_columns \u003d df.columns\n    df \u003d df.where(\"category_code is not null and brand is not null\")\n    df_activity \u003d df.groupBy(\u0027user_session\u0027).count()\n    df \u003d df.select(\u0027*\u0027).where(\"event_type \u003d \u0027cart\u0027 or event_type \u003d \u0027purchase\u0027\").dropDuplicates(subset \u003d [\u0027event_type\u0027, \u0027product_id\u0027,\u0027price\u0027, \u0027user_id\u0027,\u0027user_session\u0027])\n    df \u003d df.withColumn(\u0027is_purchased\u0027, f.when(f.col(\u0027event_type\u0027) \u003d\u003d \u0027purchase\u0027, 1).otherwise(0))\n    \n    #chop the dataset into 2 sets by event_type\n    df_cart \u003d df.select(\u0027*\u0027).where(\"event_type \u003d \u0027cart\u0027\")\n    df_purchase \u003d df.select(\u0027*\u0027).where(\"event_type \u003d \u0027purchase\u0027\")\n    \n    df_cart_purchase\u003ddf_cart.alias(\u0027a\u0027)\\\n                            .join(df_purchase.alias(\u0027b\u0027),\n                                  [\u0027user_session\u0027, \u0027product_id\u0027], \n                                  how\u003d\u0027left\u0027)\\\n                            .select(\u0027user_session\u0027, \u0027product_id\u0027, \u0027a.event_time\u0027, \u0027a.event_type\u0027, \u0027a.product_id\u0027, \u0027a.category_id\u0027, \u0027a.category_code\u0027, \u0027a.brand\u0027, \u0027a.price\u0027, \u0027a.user_id\u0027,\n                                    f.coalesce(\u0027b.is_purchased\u0027, \u0027a.is_purchased\u0027).alias(\u0027is_purchased\u0027))\n    \n    #join the activity_count\n    df_cart_purchase\u003ddf_cart_purchase.join(df_activity, \u0027user_session\u0027) \\\n                                     .select(\u0027*\u0027) \\\n                                     .withColumnRenamed(\u0027count\u0027, \u0027activity_count\u0027)\n\n    #split the category_code by .\n    df_cart_purchase \u003d df_cart_purchase.select(\u0027*\u0027, f.split(\u0027category_code\u0027,\"\\\\.\")[0], f.split(\u0027category_code\u0027,\"\\\\.\")[1], f.split(\u0027category_code\u0027,\"\\\\.\")[2])\\\n                                      .withColumnRenamed(\u0027split(category_code, \\.)[0]\u0027, \u0027category_code_level1\u0027) \\\n                                      .withColumnRenamed(\u0027split(category_code, \\.)[1]\u0027, \u0027category_code_level2\u0027) \\\n                                      .withColumnRenamed(\u0027split(category_code, \\.)[2]\u0027, \u0027category_code_level4\u0027)\n    # df_cart_purchase.printSchema()\n    df_cart_purchase \u003d df_cart_purchase.select(\u0027*\u0027, f.date_format(f.col(\u0027event_time\u0027),\u0027u\u0027).alias(\u0027week_day\u0027), f.coalesce(\u0027category_code_level2\u0027, \u0027category_code_level4\u0027).alias(\u0027category_code_level3\u0027))\n    \n    # Send to MongoDB \n    # df_cart_purchase.write\\\n    #                 .format(\"mongo\")\\\n    #                 .mode(\"append\")\\\n    #                 .option(\"database\",\"2020MSBD5003GP11\")\\\n    #                 .option(\"collection\", \"brandcounts2\")\\\n    #                 .save()\n                    \n    print(df_cart_purchase.count())\n    df_cart_purchase.show(1)\n    \"\"\"\n    # These are for spark ml transformation\n    indexer \u003d StringIndexer(inputCols\u003d[\u0027brand\u0027, \u0027category_code_level1\u0027, \u0027category_code_level2\u0027,\u0027category_code_level3\u0027], outputCols\u003d[\u0027brandIndex\u0027, \u0027category_code_level1_index\u0027, \u0027category_code_level2_index\u0027,\u0027category_code_level3_index\u0027])\n    \n    #Vector Assembler - all numeric features\n    assembler \u003d VectorAssembler().setInputCols ([\"product_id\",\n                                                 \"category_id\",\n                                                 \"brandIndex\",\n                                                 \"price\",\n                                                 \"week_day\",\n                                                 \"user_id\",\n                                                 \"category_code_level1_index\",\n                                                 \"category_code_level2_index\",\n                                                 \"category_code_level3_index\",\n                                                 \"activity_count\"])\\\n                                 .setOutputCol (\"vectorized_features\")\n\n    #LabelIndex - the label is_purchased\n    label_indexer \u003d StringIndexer().setInputCol (\"is_purchased\")\\\n                                   .setOutputCol (\"label\")\n         \n    #Standardize numerical features \n    scaler \u003d StandardScaler().setInputCol (\"vectorized_features\")\\\n                             .setOutputCol (\"features\")\n                             \n    #Run Pipeline of transformers\n    pipeline_stages\u003dPipeline()\\\n                    .setStages([indexer,assembler,label_indexer,scaler])\n    pipeline_model\u003dpipeline_stages.fit(df_cart_purchase)\n    pipeline_df\u003dpipeline_model.transform(df_cart_purchase)\n\n    #Select Data for Modeling\n    selectedCols \u003d original_columns + [\u0027features\u0027, \u0027label\u0027] \n    pipeline_df \u003d pipeline_df.select(selectedCols)\n    \"\"\"\n",
      "user": "anonymous",
      "dateUpdated": "2020-12-17 08:09:02.688",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1608171661708_-522801914",
      "id": "20201217-022101_1844744208",
      "dateCreated": "2020-12-17 02:21:01.708",
      "dateStarted": "2020-12-17 08:09:02.709",
      "dateFinished": "2020-12-17 08:09:02.826",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%consumer.pyspark\nimport json\nfrom pyspark.streaming.kafka import KafkaUtils\nfrom pyspark.streaming import StreamingContext\nfrom pyspark.sql import SparkSession\n\n\ntry:\n    # Reset streaming context if exists\n    ssc.stop(stopSparkContext\u003dFalse, stopGraceFully\u003dFalse)\nexcept:\n    pass\n\nssc \u003d StreamingContext(sc, batchDuration\u003d5)\n\nREDDIT_TOPIC \u003d \"default_topic\"\nKAFKA_BROKERS \u003d \"172.25.0.12:9092,172.25.0.13:9092\"\n\nspark \u003d SparkSession\\\n                    .builder\\\n                    .appName(\"toMongoDB\")\\\n                    .config(\"spark.mongodb.input.uri\", \"mongodb+srv://admin:12345678Pc@cluster0.k5xvg.mongodb.net/2020MSBD5003GP11.BehaviorData?retryWrites\u003dtrue\u0026w\u003dmajority\") \\\n                    .config(\"spark.mongodb.output.uri\", \"mongodb+srv://admin:12345678Pc@cluster0.k5xvg.mongodb.net/2020MSBD5003GP11.BehaviorData?retryWrites\u003dtrue\u0026w\u003dmajority\") \\\n                    .getOrCreate()\n\nstream \u003d KafkaUtils.createDirectStream(\n                            ssc, \n                            [REDDIT_TOPIC], \n                            {\"metadata.broker.list\": KAFKA_BROKERS})\n\nstream_dict \u003d stream.map(lambda x: json.loads(x[1]))\n\nstream_dict.foreachRDD(transformer) # data transformation \n\n\nssc.start()\nssc.awaitTermination()\n",
      "user": "anonymous",
      "dateUpdated": "2020-12-17 08:11:08.899",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 84.0,
              "optionOpen": false
            }
          }
        },
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "ERROR",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|013938d0-4775-462...|   1005123|2019-10-01 09:03:...|      cart|   1005123|2053013555631882655|electronics.smart...|apple|1181.5|532091393|           1|             3|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n10\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code| brand|price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|93855d11-0e73-46a...|   1005006|2019-10-01 09:11:...|      cart|   1005006|2053013555631882655|electronics.smart...|xiaomi|90.34|555560569|           0|             1|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n52\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code| brand|price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|93855d11-0e73-46a...|   1005006|2019-10-01 09:12:...|      cart|   1005006|2053013555631882655|electronics.smart...|xiaomi|90.34|555560569|           0|             2|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n50\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|  brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|e0c273d6-6114-447...|   1004767|2019-10-01 09:18:...|      cart|   1004767|2053013555631882655|electronics.smart...|samsung|254.26|554784238|           0|             1|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n38\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|  brand|price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|1cbc6825-fcb6-4c5...|   1004856|2019-10-01 09:22:...|      cart|   1004856|2053013555631882655|electronics.smart...|samsung|130.7|555564447|           0|             2|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n55\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|  brand|price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|6291b1a3-5ab3-423...|   1004211|2019-10-01 09:28:...|      cart|   1004211|2053013555631882655|electronics.smart...|samsung|97.79|555502630|           0|             2|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n53\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|  brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|b5770b0e-9447-4c6...|   1004750|2019-10-01 09:34:...|      cart|   1004750|2053013555631882655|electronics.smart...|samsung|203.35|514033022|           0|             2|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n58\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|  brand|price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|aab3a3bc-8f2f-430...|   1004856|2019-10-01 09:38:...|      cart|   1004856|2053013555631882655|electronics.smart...|samsung|130.7|549022803|           1|             3|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n40\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|  brand|price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|ae30bc40-132e-48b...|   1004856|2019-10-01 09:44:...|      cart|   1004856|2053013555631882655|electronics.smart...|samsung|130.7|514222948|           0|             2|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n48\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|  brand|price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|0ed66541-6129-4fb...|   1004856|2019-10-01 09:51:...|      cart|   1004856|2053013555631882655|electronics.smart...|samsung|130.7|514925180|           0|             2|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n55\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|  brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|e09d5beb-585b-4d4...|   1004836|2019-10-01 09:58:...|      cart|   1004836|2053013555631882655|electronics.smart...|samsung|241.18|553013717|           0|             1|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n50\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|  brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|1b263380-0789-43b...|   1004874|2019-10-01 10:01:...|      cart|   1004874|2053013555631882655|electronics.smart...|samsung|383.51|539136857|           0|             5|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n59\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|  brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|1b263380-0789-43b...|   1004875|2019-10-01 10:11:...|      cart|   1004875|2053013555631882655|electronics.smart...|samsung|388.68|539136857|           0|             3|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n56\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|brand|price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|9cbe93ca-83ad-456...|   5701166|2019-10-01 10:15:...|      cart|   5701166|2053013553970938175|auto.accessories....|     |136.4|555252635|           0|             3|                auto|         accessories|              player|    null|         accessories|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n40\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|0d119d48-c82f-482...|   1002544|2019-10-01 10:18:...|      cart|   1002544|2053013555631882655|electronics.smart...|apple|464.06|516868251|           0|             7|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n46\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+-------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|brand|  price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+-------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|33518de7-b095-4bc...|   1004227|2019-10-01 10:24:...|      cart|   1004227|2053013555631882655|electronics.smart...|apple|1012.77|526923573|           0|             2|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+-------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n44\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|d31cb50d-2127-4ed...|   1005121|2019-10-01 10:30:...|      cart|   1005121|2053013555631882655|electronics.smart...|apple|975.57|555583810|           1|             7|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n46\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code| brand|price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|ff3e383a-4d46-4f7...|   4804295|2019-10-01 10:37:...|      cart|   4804295|2053013554658804075|electronics.audio...|xiaomi|22.39|548091869|           0|             2|         electronics|               audio|           headphone|    null|               audio|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n51\n+--------------------+----------+--------------------+----------+----------+-------------------+-------------+-----+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|category_code|brand|price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+-------------+-----+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|5b6aef8e-e458-456...|  10701101|2019-10-01 10:46:...|      cart|  10701101|2053013561277416167|             |   ea|74.36|555590494|           0|             2|                    |                null|                null|    null|                null|\n+--------------------+----------+--------------------+----------+----------+-------------------+-------------+-----+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n39\n+--------------------+----------+--------------------+----------+----------+-------------------+-------------+--------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|category_code|   brand|price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+-------------+--------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|fa1716ed-a6f2-43c...|  12703494|2019-10-01 10:47:...|      cart|  12703494|2053013553559896355|             |cordiant| 39.9|555591558|           0|             2|                    |                null|                null|    null|                null|\n+--------------------+----------+--------------------+----------+----------+-------------------+-------------+--------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n33\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|  brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|33bdb665-bac8-49a...|   1004858|2019-10-01 10:58:...|      cart|   1004858|2053013555631882655|electronics.smart...|samsung|133.81|488379220|           0|             1|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n49\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|brand|price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|bbe7db9d-39ad-422...|   6201022|2019-10-01 11:02:...|      cart|   6201022|2053013552293216471|appliances.enviro...|     |83.63|514746894|           0|             2|          appliances|         environment|          air_heater|    null|         environment|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n39\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|  brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|6cb51307-ea69-48e...|   3600661|2019-10-01 11:07:...|      cart|   3600661|2053013563810775923|appliances.kitche...|samsung|295.49|541798564|           1|             4|          appliances|             kitchen|              washer|    null|             kitchen|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n47\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|  brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|67cde867-fea4-4d0...|   1004767|2019-10-01 11:16:...|      cart|   1004767|2053013555631882655|electronics.smart...|samsung|254.26|547447277|           0|             3|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n45\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|  brand|price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|3182ddd2-3868-408...|   1004856|2019-10-01 11:18:...|      cart|   1004856|2053013555631882655|electronics.smart...|samsung|130.7|555601281|           0|             2|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n32\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code| brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|1681db1c-449d-4f9...|   1005004|2019-10-01 11:24:...|      cart|   1005004|2053013555631882655|electronics.smart...|huawei|257.16|555600920|           0|             5|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n41\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|54d5694f-45c7-413...|   4804056|2019-10-01 11:33:...|      cart|   4804056|2053013554658804075|electronics.audio...|apple|161.93|522964376|           0|             2|         electronics|               audio|           headphone|    null|               audio|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n43\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+-------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|brand|  price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+-------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|adf7e49a-4694-468...|   1005132|2019-10-01 11:35:...|      cart|   1005132|2053013555631882655|electronics.smart...|apple|1413.16|514702450|           0|             4|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+-------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n43\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|  brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|5d2d043f-e0c6-421...|   1004873|2019-10-01 11:40:...|      cart|   1004873|2053013555631882655|electronics.smart...|samsung|388.43|513016930|           1|             2|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n42\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|brand|price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|cf0cf8b6-aa24-45e...|  12300393|2019-10-01 11:48:...|      cart|  12300393|2053013556311359947|construction.tool...|     | 39.1|539284590|           0|             5|        construction|               tools|               drill|    null|               tools|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n32\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|6bca9d9e-3879-4e5...|   1003306|2019-10-01 11:57:...|      cart|   1003306|2053013555631882655|electronics.smart...|apple|587.47|555614036|           1|             3|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n37\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|62415c9a-33c0-4f8...|   4804056|2019-10-01 12:02:...|      cart|   4804056|2053013554658804075|electronics.audio...|apple|161.93|554083141|           0|             3|         electronics|               audio|           headphone|    null|               audio|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n44\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|brand|price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|e8d22a8c-880a-464...|  12400002|2019-10-01 12:07:...|      cart|  12400002|2053013556252639687|construction.tool...|bosch|88.81|555322861|           0|             2|        construction|               tools|               drill|    null|               tools|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+-----+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n36\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|6d5f6569-d3b8-448...|   1004250|2019-10-01 12:12:...|      cart|   1004250|2053013555631882655|electronics.smart...|apple|803.24|555619922|           0|             1|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n39\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|c84852c2-fec6-427...|   1003317|2019-10-01 12:23:...|      cart|   1003317|2053013555631882655|electronics.smart...|apple|965.02|548720234|           0|             2|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n36\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|  brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|255d6331-d534-42b...|   1004872|2019-10-01 12:27:...|      cart|   1004872|2053013555631882655|electronics.smart...|samsung|286.35|552826211|           0|             1|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-------+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n47\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|7a0c270a-4208-44d...|   1003306|2019-10-01 12:30:...|      cart|   1003306|2053013555631882655|electronics.smart...|apple|587.47|524622565|           0|             5|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n27\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|        user_session|product_id|          event_time|event_type|product_id|        category_id|       category_code|brand| price|  user_id|is_purchased|activity_count|category_code_level1|category_code_level2|category_code_level4|week_day|category_code_level3|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\n|1ed6cc5c-f2ad-405...|   1003312|2019-10-01 12:39:...|      cart|   1003312|2053013555631882655|electronics.smart...|apple|710.17|513803667|           0|             2|         electronics|          smartphone|                null|    null|          smartphone|\n+--------------------+----------+--------------------+----------+----------+-------------------+--------------------+-----+------+---------+------------+--------------+--------------------+--------------------+--------------------+--------+--------------------+\nonly showing top 1 row\n\n49\n\u001b[0;31m\u001b[0m\n\u001b[0;31mKeyboardInterrupt\u001b[0mTraceback (most recent call last)\n\u001b[0;32m\u003cipython-input-10-c75b3b058941\u003e\u001b[0m in \u001b[0;36m\u003cmodule\u003e\u001b[0;34m()\u001b[0m\n\u001b[1;32m     29\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     30\u001b[0m \u001b[0mssc\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstart\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---\u003e 31\u001b[0;31m \u001b[0mssc\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mawaitTermination\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\n\u001b[0;32m/zeppelin/interpreter/spark/pyspark/pyspark.zip/pyspark/streaming/context.py\u001b[0m in \u001b[0;36mawaitTermination\u001b[0;34m(self, timeout)\u001b[0m\n\u001b[1;32m    204\u001b[0m         \"\"\"\n\u001b[1;32m    205\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mtimeout\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--\u003e 206\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_jssc\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mawaitTermination\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    207\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    208\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_jssc\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mawaitTerminationOrTimeout\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m \u001b[0;34m*\u001b[0m \u001b[0;36m1000\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\n\u001b[0;32m/zeppelin/interpreter/spark/pyspark/py4j-0.10.4-src.zip/py4j/java_gateway.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, *args)\u001b[0m\n\u001b[1;32m   1129\u001b[0m             \u001b[0mproto\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mEND_COMMAND_PART\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1130\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-\u003e 1131\u001b[0;31m         \u001b[0manswer\u001b[0m \u001b[0;34m\u003d\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mgateway_client\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msend_command\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcommand\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1132\u001b[0m         return_value \u003d get_return_value(\n\u001b[1;32m   1133\u001b[0m             answer, self.gateway_client, self.target_id, self.name)\n\n\u001b[0;32m/zeppelin/interpreter/spark/pyspark/py4j-0.10.4-src.zip/py4j/java_gateway.py\u001b[0m in \u001b[0;36msend_command\u001b[0;34m(self, command, retry, binary)\u001b[0m\n\u001b[1;32m    881\u001b[0m         \u001b[0mconnection\u001b[0m \u001b[0;34m\u003d\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_connection\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    882\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--\u003e 883\u001b[0;31m             \u001b[0mresponse\u001b[0m \u001b[0;34m\u003d\u001b[0m \u001b[0mconnection\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msend_command\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcommand\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    884\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mbinary\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    885\u001b[0m                 \u001b[0;32mreturn\u001b[0m \u001b[0mresponse\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_create_connection_guard\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mconnection\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\n\u001b[0;32m/zeppelin/interpreter/spark/pyspark/py4j-0.10.4-src.zip/py4j/java_gateway.py\u001b[0m in \u001b[0;36msend_command\u001b[0;34m(self, command)\u001b[0m\n\u001b[1;32m   1026\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1027\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-\u003e 1028\u001b[0;31m             \u001b[0manswer\u001b[0m \u001b[0;34m\u003d\u001b[0m \u001b[0msmart_decode\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstream\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mreadline\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1029\u001b[0m             \u001b[0mlogger\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdebug\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"Answer received: {0}\"\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mformat\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0manswer\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1030\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0manswer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstartswith\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mproto\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mRETURN_MESSAGE\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\n\u001b[0;32m/opt/conda/lib/python2.7/socket.pyc\u001b[0m in \u001b[0;36mreadline\u001b[0;34m(self, size)\u001b[0m\n\u001b[1;32m    449\u001b[0m             \u001b[0;32mwhile\u001b[0m \u001b[0mTrue\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    450\u001b[0m                 \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--\u003e 451\u001b[0;31m                     \u001b[0mdata\u001b[0m \u001b[0;34m\u003d\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_sock\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mrecv\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_rbufsize\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    452\u001b[0m                 \u001b[0;32mexcept\u001b[0m \u001b[0merror\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    453\u001b[0m                     \u001b[0;32mif\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m\u003d\u003d\u001b[0m \u001b[0mEINTR\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\n\u001b[0;31mKeyboardInterrupt\u001b[0m: "
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1608129051846_667158852",
      "id": "20201216-143051_1465935924",
      "dateCreated": "2020-12-16 14:30:51.847",
      "dateStarted": "2020-12-17 08:09:08.700",
      "dateFinished": "2020-12-17 08:12:17.769",
      "status": "ABORT",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "sc.version",
      "user": "anonymous",
      "dateUpdated": "2020-12-17 01:35:05.892",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "res1: String \u003d 2.2.1\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1608129160513_-942212829",
      "id": "20201216-143240_1248923218",
      "dateCreated": "2020-12-16 14:32:40.513",
      "dateStarted": "2020-12-17 01:35:05.912",
      "dateFinished": "2020-12-17 01:35:05.998",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Kafka Spark Streaming",
  "id": "2EAB941ZD",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "producer:shared_process": [],
    "consumer:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false,
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {}
}